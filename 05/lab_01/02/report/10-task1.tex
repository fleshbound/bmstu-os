\chapter{Функции обработчика прерывания от системного таймера в системах разделения времени}

\section{UNIX/Linux}

Обработчик прерывания от системного таймера выполняет несколько функций.

По \textbf{тику}:
\begin{itemize}
	\item инкремент счетчика реального времени;
	\item декремент кванта текущего потока;
	\item обновление статистики использования потока текущим процессом --- инкремент поля \textbf{c\_cpu} дексриптора текущего потока до максимального значения 127;
	\item декремент счетчиков времени до отправки на выполнение отложенных вызовов, при достижении счетчиком нуля происходит установка флага для обработчика отложенных вызовов.
\end{itemize}

По \textbf{главному тику}:
\begin{itemize}
	\item инициализацию отложенных действий;
	\item пробуждение системных потоков \textbf{swapper}, \textbf{pagedaemon}, то есть регистрация отложенного вызова процедуры \textbf{wakeup}, которая перемещает дескрипторы процессов из списка <<спящих>> в очередь готовых потоков;
	\item декремент счетчика времени до отправки одного из следующих сигналов:
	\begin{enumerate}
		\item \textbf{SIGALRM} --- сигнал, посылаемый потоку по истечении времени, которое задано с помощью функции \textbf{alarm()};
		\item \textbf{SIGPROF} --- сигнал, посылаемый потоку по истечении времени, которое задано в таймере;
		\item \textbf{SIGVTALRM} --- сигнал, посылаемый потоку по истечении времени, которое задано в таймере.
	\end{enumerate}
\end{itemize}

Обработчик прерывания от системного таймера \textbf{по кванту} посылает сигнал \textbf{SIGXCPU} текущему потоку при истечении кванта.

\section{Windows}

Обработчик прерывания от системного таймера выполняет несколько функций.

По \textbf{тику}:
\begin{itemize}
	\item инкремент счетчика тиков;
	\item декремент кванта;
	\item декремент счетчиков отложенных задач.
\end{itemize}

По \textbf{главному тику}:
\begin{itemize}
	\item постановка в очередь DCP (Deferred Procedure Call) отложенного вызова обработчика ловушки профилирования ядра;
	\item освобождение объекта «событие», которое ожидает диспетчер настройки баланса. Диспетчер настройки баланса сканирует очередь готовых процессов и повышает приоритет процессов, которые находились в состоянии ожидания дольше 4 секунд.
\end{itemize}

Обработчик прерывания от системного таймера \textbf{по кванту} инициализирует диспетчеризацию потоков --- добавление соответствующего объекта в очередь \textbf{DPS}.